<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Excel导入导出插件使用说明文档 | 个人博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="简介excel-util.jar包是基于EasyExcel的二次封装，满足公司各系统常用的excel导入导出的简化操作和自定义配置。更多底层api功能说明请查看EasyExcel官方文档 基础环境Java使用Jdk1.8作为开发SDK Maven工具类包 12345&lt;dependency&gt;      &lt;groupId&gt;com.zejia.ms.bps&lt;&#x2F;groupId">
<meta property="og:type" content="article">
<meta property="og:title" content="Excel导入导出插件使用说明文档">
<meta property="og:url" content="https://daoqing312.github.io/2022/03/12/Excel%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/index.html">
<meta property="og:site_name" content="个人博客">
<meta property="og:description" content="简介excel-util.jar包是基于EasyExcel的二次封装，满足公司各系统常用的excel导入导出的简化操作和自定义配置。更多底层api功能说明请查看EasyExcel官方文档 基础环境Java使用Jdk1.8作为开发SDK Maven工具类包 12345&lt;dependency&gt;      &lt;groupId&gt;com.zejia.ms.bps&lt;&#x2F;groupId">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-03-12T11:38:41.120Z">
<meta property="article:modified_time" content="2022-03-12T12:20:09.714Z">
<meta property="article:author" content="道庆">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="个人博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.1.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">个人博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://daoqing312.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Excel导入导出使用说明文档" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/03/12/Excel%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/" class="article-date">
  <time class="dt-published" datetime="2022-03-12T11:38:41.120Z" itemprop="datePublished">2022-03-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Excel导入导出插件使用说明文档
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>excel-util.jar包是基于EasyExcel的二次封装，满足公司各系统常用的excel导入导出的简化操作和自定义配置。更多底层api功能说明请查看<a target="_blank" rel="noopener" href="https://alibaba-easyexcel.github.io/index.html" title="官方文档">EasyExcel官方文档</a></p>
<h4 id="基础环境"><a href="#基础环境" class="headerlink" title="基础环境"></a>基础环境</h4><h5 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h5><p>使用Jdk1.8作为开发SDK</p>
<h5 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h5><p>工具类包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zejia.ms.bps<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>excel-util<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第三方依赖包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.7.14<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hibernate.validator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hibernate-validator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.6.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="代码地址"><a href="#代码地址" class="headerlink" title="代码地址"></a>代码地址</h4><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/daoqing312/excel-util">插件地址</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/daoqing312/excel-demo">插件使用Demo地址</a></li>
</ul>
<h5 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h5><p>导出分为两种方式，一种直接以流的方式输出页面下载，一种是写入到磁盘目录下。写入磁盘目录需要在引用此jar包的工程目录src路径下创建excel.conf文件，配置excel导出磁盘路径。</p>
<h4 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h4><h5 id="包结构说明"><a href="#包结构说明" class="headerlink" title="包结构说明"></a>包结构说明</h5><p>excel-uitl目录结构描述</p>
<p>|—src&#x2F;main&#x2F;java</p>
<p>|—|—com.zejia.excel</p>
<p>|—|—|—conveter 读写转换类</p>
<p>|—|—|—listener 读监听类</p>
<p>|—|—|—handler 写出处理类</p>
<p>|—|—|—support 支持类</p>
<p>|—|—|—util 工具类</p>
<p>|—pom.xml</p>
<h5 id="主要类说明"><a href="#主要类说明" class="headerlink" title="主要类说明"></a>主要类说明</h5><h6 id="ExcelRequest"><a href="#ExcelRequest" class="headerlink" title="ExcelRequest"></a>ExcelRequest</h6><p>自定义配置自定义参数的对象封装和默认值。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@intro</span> 导入导出配置对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zhaowb</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/02/07</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Comment(&quot;导入导出配置对象&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExcelRequest</span> <span class="keyword">extends</span> <span class="title class_">BizPageRequest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Comment(value = &quot;sheet下标,默认0&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer sheetNo=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Comment(value = &quot;sheet名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String sheetName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Comment(value = &quot;解析指定标题头行数，默认1&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer headRowNumber=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Comment(value = &quot;导出忽略字段集&quot;)</span></span><br><span class="line">    Set&lt;String&gt; excludeColumnFiledNames = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Comment(value = &quot;导出包括字段集&quot;)</span></span><br><span class="line">    Set&lt;String&gt; includeColumnFiledNames = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Comment(value = &quot;是否读取全部sheet 0否 1是，默认0&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer readAllSheet=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Comment(value = &quot;是否压缩 true是 false否&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Boolean isZip=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Comment(value = &quot;是否删除临时文件 true是 false否&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Boolean isDelete=<span class="literal">true</span>;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="ExcelUtils"><a href="#ExcelUtils" class="headerlink" title="ExcelUtils"></a>ExcelUtils</h6><p>说明：导入导出静态工具类，包含了导入导出多种场景的静态方法。一般场景推荐使用此工具类方法完成。</p>
<p>方法说明</p>
<ol>
<li><p>写入excel</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 写入excel</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> outputStream 输出流</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> excelRequest 自定义配置对象</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> clazz 表头类</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> datalist 表格数据</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">writeExcel</span><span class="params">(OutputStream outputStream, ExcelRequest excelRequest, Class&lt;?&gt; clazz, List&lt;?&gt; datalist)</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>excel表格封装导出</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * excel表格封装导出</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filePath 文件路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dataList 表格数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> head 表格复杂头封装</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheetName 表格名称</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt; 数据类型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">writeExcelDynamicHead</span><span class="params">(String filePath, List&lt;T&gt; dataList, List&lt;List&lt;String&gt;&gt; head, String sheetName)</span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>excel导出写入到多sheet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * excel导出写入多sheet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filePath 文件路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dataMap 表格数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz 表格对象类</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt; 数据类型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">writeExcelManySheets</span><span class="params">(String filePath, Map&lt;String, List&lt;T&gt;&gt; dataMap, Class&lt;T&gt; clazz)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>excel导出写入输出流，出错抛出异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 导出写入输出流</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outputStream 输出流</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dataList 表格数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheetName 表格名称</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz 表格对象类</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt; 数据类型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">writeExcelDownload</span><span class="params">(OutputStream outputStream, List&lt;T&gt; dataList, String sheetName, Class&lt;T&gt; clazz)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">       ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>excel导出并下载</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 导出并下载</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> response HttpServletResponse</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> fileName 文件名</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> dataList 表格数据</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> sheetName 表格名称</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> &lt;T&gt; 数据类型</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">writeExcelDownload</span><span class="params">(HttpServletResponse response,String fileName, String sheetName,List&lt;List&lt;String&gt;&gt; headList,List&lt;T&gt; dataList)</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>自定义头的导出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义头的导出</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> outputStream 输出流</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> dataList 导出数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head 自定义表头</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> sheetName 表名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;T&gt; 数据类型</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">writeExcelDynamicHead</span><span class="params">(OutputStream outputStream, List&lt;T&gt; dataList, List&lt;List&lt;String&gt;&gt; head, String sheetName)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>多sheet的写入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 多sheet的导出</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> outputStream 输出流</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> dataMap 导出数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> clazz 表头类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;T&gt; 数据类型</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">writeExcelManySheets</span><span class="params">(OutputStream outputStream, Map&lt;String, List&lt;T&gt;&gt; dataMap, Class&lt;T&gt; clazz)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>多页数据写入单sheet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 多页数据写入单sheet</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fileName  导出文件名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> sheetName 导出sheet名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> clazz     excel对象模型</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> excelRequest   查询参数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pageInvokeHandler  分页查询方法</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> excel文件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">writePagesData2ExcelOneSheet</span><span class="params">(String fileName, String sheetName, ExcelRequest excelRequest</span></span><br><span class="line"><span class="params">        , IPageInvokeHandler pageInvokeHandler, Class&lt;T&gt; clazz, List&lt;List&lt;String&gt;&gt; heads)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>多页数据写入多sheet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 多页数据写入多sheet</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fileName  导出文件名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> sheetName 导出sheet名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> clazz     excel对象模型</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pageRequest   查询参数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pageInvokeHandler  分页查询方法</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> excel文件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">writePagesData2ExcelMultiSheet</span><span class="params">(String fileName, String sheetName, BizPageRequest pageRequest</span></span><br><span class="line"><span class="params">        ,IPageInvokeHandler pageInvokeHandler, Class&lt;T&gt; clazz, List&lt;List&lt;String&gt;&gt; heads)</span> &#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>多页数据写入多个文件后ZIP压缩</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 多页数据写入多个文件后ZIP压缩</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> zipFileName 压缩文件名</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> sheetName 表格名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pageRequest 分页参数对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pageInvokeHandler  分页查询方法</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> clazz 表头类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> heads 自定义表头</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">writePagesData2MultiFileAndZip</span><span class="params">(String zipFileName,String sheetName,BizPageRequest pageRequest,IPageInvokeHandler pageInvokeHandler, Class&lt;T&gt; clazz, List&lt;List&lt;String&gt;&gt; heads)</span> &#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>导出并下载</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 导出并下载</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> response HttpServletResponse</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fileName 文件名</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> dataList 表格数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> excelRequest 自定义配置</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;T&gt; 数据类型</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">writeExcelWeb</span><span class="params">(HttpServletResponse response,String fileName, ExcelRequest excelRequest,List&lt;List&lt;String&gt;&gt; headList,List&lt;T&gt; dataList)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>模板导出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 模板导出</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> outputStream 输出流</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> templateName 模板路径</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> head 表头</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> datalist 表数据</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">fillExcelWithTemplate</span><span class="params">(OutputStream outputStream,String templateName, Class&lt;?&gt; head, List&lt;?&gt; datalist)</span> &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>写入excel</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 写入excel</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> outputStream 输入流</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> dataList 导入数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> headList 表头列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> excelRequest 自定义配置</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> writeHandlers 写入处理器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">writeExcelWithHandler</span><span class="params">(OutputStream outputStream, List&lt;List&lt;String&gt;&gt; headList, List&lt;?&gt; dataList, ExcelRequest excelRequest, WriteHandler... writeHandlers)</span> &#123;</span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>写入excel</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 写入excel</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> outputStream 输入流</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> dataList 导入数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head 表头Class</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> excelRequest 自定义配置</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> writeHandlers 写入处理器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">writeExcelWithHandler</span><span class="params">(OutputStream outputStream, Class&lt;?&gt; head, List&lt;?&gt; dataList, ExcelRequest excelRequest, WriteHandler... writeHandlers)</span> &#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>读取excel</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 读取excel</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> inputStream</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> clazz 表头类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> listener 读取监听类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> excelRequest 自定义配置对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> converters 内容转换器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">readExcel</span><span class="params">(InputStream inputStream, Class clazz, BatchImportListener listener, ExcelRequest excelRequest, Converter ...converters)</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>读取excel</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 读取excel</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> inputStream</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> clazz 表头类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> excelRequest 自定义配置对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> readListeners 读取监听类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">readExcel</span><span class="params">(InputStream inputStream, Class clazz, ExcelRequest excelRequest, ReadListener ...readListeners)</span>&#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h6 id="ExcelReadHelper"><a href="#ExcelReadHelper" class="headerlink" title="ExcelReadHelper"></a>ExcelReadHelper</h6><p>说明：excel读取类，实例化后可以进行更灵活配置。优先推荐使用ExcelUtils工具类的静态方法。</p>
<h6 id="ExcelWriteHelper"><a href="#ExcelWriteHelper" class="headerlink" title="ExcelWriteHelper"></a>ExcelWriteHelper</h6><p>说明：excel写入类，实例化后可以进行更灵活配置。优先推荐使用ExcelUtils工具类的静态方法。</p>
<h6 id="FileUtils"><a href="#FileUtils" class="headerlink" title="FileUtils"></a>FileUtils</h6><p>说明：文件工具类，包含写入excel路径生成、文件随机名称生成、ZIP压缩等方法。具体参看代码。</p>
<h6 id="StyleUtils"><a href="#StyleUtils" class="headerlink" title="StyleUtils"></a>StyleUtils</h6><p>说明：样式工具类，后续优化，目前可忽略。</p>
<h6 id="excel读监听器"><a href="#excel读监听器" class="headerlink" title="excel读监听器"></a>excel读监听器</h6><p>在读取excel解析时可以传入监听器接口ReadListener的实现类，对每一行数据进行自定义处理，异常处理等。一般处理不满足时可自定义监听器类，常用监听器实现类如下：</p>
<p><em><strong>BatchImportListener</strong></em></p>
<p>说明：excel读取监听器，每解析一行会回调invoke()方法,整个excel解析结束会执行doAfterAllAnalysed()方法。构造方法传入回调函数接口，方便对读取后的数据进行日志打印或持久化处理。</p>
<hr>
<p><em><strong>HibernateValidateListener</strong></em></p>
<p>说明：excel读取数据校验监听器，可以使用后端常用的hibernate-validator注解。</p>
<h6 id="excel读写转换器类"><a href="#excel读写转换器类" class="headerlink" title="excel读写转换器类"></a>excel读写转换器类</h6><p>说明：excel单元格内容的读入和写入转换处理类。常用的如日期转换类、自定义格式转换类等。如需自定义,可实现Converter接口。参考实现：CustomStringConverter、CustomDateConverter等。</p>
<h6 id="excel写处理类"><a href="#excel写处理类" class="headerlink" title="excel写处理类"></a>excel写处理类</h6><p>说明：写的处理器。可以实现WorkbookWriteHandler,SheetWriteHandler,RowWriteHandler,CellWriteHandler，在写入excel的不同阶段会调用excel单元格内容的写入内容样式处理类</p>
<h4 id="Demo工程"><a href="#Demo工程" class="headerlink" title="Demo工程"></a>Demo工程</h4><p>excel-demo是基于springboot2创建的导入导出示例代码。用代码示例说明比语言描述更直接，也对开发更友好。如果使用此工具包，建议查看示例和单元测试，以便快速了解不同场景的使用方式。</p>
<h4 id="EasyExcel说明"><a href="#EasyExcel说明" class="headerlink" title="EasyExcel说明"></a>EasyExcel说明</h4><h5 id="注解说明"><a href="#注解说明" class="headerlink" title="注解说明"></a>注解说明</h5><table>
<thead>
<tr>
<th align="left">字段注解</th>
<th>类注解</th>
</tr>
</thead>
<tbody><tr>
<td align="left">@ColumnWith(列宽)</td>
<td>@ColumnWidth(全局列宽)</td>
</tr>
<tr>
<td align="left">@ExcelProperty(字段配置</td>
<td>@HeadFontStyle(头样式)</td>
</tr>
<tr>
<td align="left"></td>
<td>@HeadRowHeight(标题高度)</td>
</tr>
<tr>
<td align="left"></td>
<td>@ContentFontStyle(内容字体样式)</td>
</tr>
<tr>
<td align="left"></td>
<td>@ContentRowHeight(内容高度)</td>
</tr>
</tbody></table>
<h6 id="ExcelProperty"><a href="#ExcelProperty" class="headerlink" title="@ExcelProperty"></a><strong>@ExcelProperty</strong></h6><p>表格字段，必要的一个注解，注解中有三个参数 <code>value</code>,<code>index</code>,<code>converter</code>分别代表列明，列序号，数据转换方式<br><code>value</code>和 <code>index</code>只能二选一，通常不用设置 <code>converter</code><br>1.value 通过标题文本对应<br>2.index 通过文本行号对应<br>3.converter 转换器，通常入库和出库转换使用，如性别入库0和1，出库男和女</p>
<p>最佳实践</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ImeiEncrypt</span> &#123;</span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;值&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String valueField;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(value = 1,converter =IndustryIdConverter.class)</span></span><br><span class="line">    <span class="keyword">private</span> String indexField;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;值对应和转换器&quot;,converter =IndustryIdConverter.class)</span></span><br><span class="line">    <span class="keyword">private</span> String valueAndConverterField;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="ColumnWith"><a href="#ColumnWith" class="headerlink" title="@ColumnWith"></a><strong>@ColumnWith</strong></h6><p>设置列宽度,只有一个参数value，value的单位是字符长度，最大可以设置255个字符，因为一个excel单元格最大可以写入的字符个数就是255个字符。</p>
<p>最佳实践</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ImeiEncrypt</span> &#123;</span><br><span class="line">    <span class="meta">@ColumnWidth(value = 18)</span></span><br><span class="line">    <span class="keyword">private</span> String imei;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="ContentFontStyle"><a href="#ContentFontStyle" class="headerlink" title="@ContentFontStyle"></a><strong>@ContentFontStyle</strong></h6><p>文本字体样式，用于设置单元格内容字体格式的注解</p>
<p>参数：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>fontName</td>
<td>字体名称</td>
</tr>
<tr>
<td>fontHeightInPoints</td>
<td>字体高度</td>
</tr>
<tr>
<td>italic</td>
<td>是否斜体</td>
</tr>
<tr>
<td>strikeout</td>
<td>是否设置删除水平线</td>
</tr>
<tr>
<td>color</td>
<td>字体颜色</td>
</tr>
<tr>
<td>typeOffset</td>
<td>偏移量</td>
</tr>
<tr>
<td>underline</td>
<td>下划线</td>
</tr>
<tr>
<td>bold</td>
<td>是否加粗</td>
</tr>
<tr>
<td>charset</td>
<td>编码格式</td>
</tr>
</tbody></table>
<h6 id="ContentLoopMerge"><a href="#ContentLoopMerge" class="headerlink" title="@ContentLoopMerge"></a>@ContentLoopMerge</h6><p>用于设置合并单元格的注解</p>
<p>参数：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>eachRow</td>
<td></td>
</tr>
<tr>
<td>columnExtend</td>
<td></td>
</tr>
</tbody></table>
<h6 id="ContentRowHeight"><a href="#ContentRowHeight" class="headerlink" title="@ContentRowHeight"></a>@ContentRowHeight</h6><p>用于设置行高</p>
<p>参数：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>value</td>
<td>行高，<code>-1</code>代表自动行高</td>
</tr>
</tbody></table>
<h6 id="ContentStyle"><a href="#ContentStyle" class="headerlink" title="@ContentStyle"></a>@ContentStyle</h6><p>设置内容格式注解</p>
<p>参数：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>dataFormat</td>
<td>日期格式</td>
</tr>
<tr>
<td>hidden</td>
<td>设置单元格使用此样式隐藏</td>
</tr>
<tr>
<td>locked</td>
<td>设置单元格使用此样式锁定</td>
</tr>
<tr>
<td>quotePrefix</td>
<td>在单元格前面增加&#96;符号，数字或公式将以字符串形式展示</td>
</tr>
<tr>
<td>horizontalAlignment</td>
<td>设置是否水平居中</td>
</tr>
<tr>
<td>wrapped</td>
<td>设置文本是否应换行。将此标志设置为 <code>true</code>通过在多行上显示使单元格中的所有内容可见</td>
</tr>
<tr>
<td>verticalAlignment</td>
<td>设置是否垂直居中</td>
</tr>
<tr>
<td>rotation</td>
<td>设置单元格中文本旋转角度。03版本的Excel旋转角度区间为-90°<del>90°，07版本的Excel旋转角度区间为0°</del> 180°</td>
</tr>
<tr>
<td>indent</td>
<td>设置单元格中缩进文本的空格数</td>
</tr>
<tr>
<td>borderLeft</td>
<td>设置左边框的样式</td>
</tr>
<tr>
<td>borderRight</td>
<td>设置右边框样式</td>
</tr>
<tr>
<td>borderTop</td>
<td>设置上边框样式</td>
</tr>
<tr>
<td>borderBottom</td>
<td>设置下边框样式</td>
</tr>
<tr>
<td>leftBorderColor</td>
<td>设置左边框颜色</td>
</tr>
<tr>
<td>rightBorderColor</td>
<td>设置右边框颜色</td>
</tr>
<tr>
<td>topBorderColor</td>
<td>设置上边框颜色</td>
</tr>
<tr>
<td>bottomBorderColor</td>
<td>设置下边框颜色</td>
</tr>
<tr>
<td>fillPatternType</td>
<td>设置填充类型</td>
</tr>
<tr>
<td>fillBackgroundColor</td>
<td>设置背景色</td>
</tr>
<tr>
<td>fillForegroundColor</td>
<td>设置前景色</td>
</tr>
<tr>
<td>shrinkToFit</td>
<td>设置自动单元格自动大小</td>
</tr>
</tbody></table>
<h6 id="HeadFontStyle"><a href="#HeadFontStyle" class="headerlink" title="@HeadFontStyle"></a>@HeadFontStyle</h6><p>用于定制标题字体格式</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>fontName</td>
<td>设置字体名称</td>
</tr>
<tr>
<td>fontHeightInPoints</td>
<td>设置字体高度</td>
</tr>
<tr>
<td>italic</td>
<td>设置字体是否斜体</td>
</tr>
<tr>
<td>strikeout</td>
<td>是否设置删除线</td>
</tr>
<tr>
<td>color</td>
<td>设置字体颜色</td>
</tr>
<tr>
<td>typeOffset</td>
<td>设置偏移量</td>
</tr>
<tr>
<td>underline</td>
<td>设置下划线</td>
</tr>
<tr>
<td>charset</td>
<td>设置字体编码</td>
</tr>
<tr>
<td>bold</td>
<td>设置字体是否加粗</td>
</tr>
</tbody></table>
<h6 id="HeadRowHeight"><a href="#HeadRowHeight" class="headerlink" title="@HeadRowHeight"></a>@HeadRowHeight</h6><p>设置标题行行高</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>value</td>
<td>设置行高，-1代表自动行高</td>
</tr>
</tbody></table>
<h6 id="HeadStyle"><a href="#HeadStyle" class="headerlink" title="@HeadStyle"></a>@HeadStyle</h6><p>设置标题样式</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>dataFormat</td>
<td>日期格式</td>
</tr>
<tr>
<td>hidden</td>
<td>设置单元格使用此样式隐藏</td>
</tr>
<tr>
<td>locked</td>
<td>设置单元格使用此样式锁定</td>
</tr>
<tr>
<td>quotePrefix</td>
<td>在单元格前面增加&#96;符号，数字或公式将以字符串形式展示</td>
</tr>
<tr>
<td>horizontalAlignment</td>
<td>设置是否水平居中</td>
</tr>
<tr>
<td>wrapped</td>
<td>设置文本是否应换行。将此标志设置为 <code>true</code>通过在多行上显示使单元格中的所有内容可见</td>
</tr>
<tr>
<td>verticalAlignment</td>
<td>设置是否垂直居中</td>
</tr>
<tr>
<td>rotation</td>
<td>设置单元格中文本旋转角度。03版本的Excel旋转角度区间为-90°<del>90°，07版本的Excel旋转角度区间为0°</del> 180°</td>
</tr>
<tr>
<td>indent</td>
<td>设置单元格中缩进文本的空格数</td>
</tr>
<tr>
<td>borderLeft</td>
<td>设置左边框的样式</td>
</tr>
<tr>
<td>borderRight</td>
<td>设置右边框样式</td>
</tr>
<tr>
<td>borderTop</td>
<td>设置上边框样式</td>
</tr>
<tr>
<td>borderBottom</td>
<td>设置下边框样式</td>
</tr>
<tr>
<td>leftBorderColor</td>
<td>设置左边框颜色</td>
</tr>
<tr>
<td>rightBorderColor</td>
<td>设置右边框颜色</td>
</tr>
<tr>
<td>topBorderColor</td>
<td>设置上边框颜色</td>
</tr>
<tr>
<td>bottomBorderColor</td>
<td>设置下边框颜色</td>
</tr>
<tr>
<td>fillPatternType</td>
<td>设置填充类型</td>
</tr>
<tr>
<td>fillBackgroundColor</td>
<td>设置背景色</td>
</tr>
<tr>
<td>fillForegroundColor</td>
<td>设置前景色</td>
</tr>
<tr>
<td>shrinkToFit</td>
<td>设置自动单元格自动大小</td>
</tr>
</tbody></table>
<h6 id="ExcelIgnore"><a href="#ExcelIgnore" class="headerlink" title="@ExcelIgnore"></a>@ExcelIgnore</h6><p>默认所有字段都会和excel去匹配，加了这个注解会忽略该字段不将该字段转换成Excel</p>
<h6 id="ExcelIgnoreUnannotated"><a href="#ExcelIgnoreUnannotated" class="headerlink" title="@ExcelIgnoreUnannotated"></a>@ExcelIgnoreUnannotated</h6><p>默认不加ExcelProperty 的注解的都会参与读写，加了不会参与没有注解的字段都不转</p>
<h6 id="DateTimeFormat"><a href="#DateTimeFormat" class="headerlink" title="@DateTimeFormat"></a>@DateTimeFormat</h6><p>日期转换，用String去接收excel日期格式的数据会调用这个注解。里面的value参照java.text.SimpleDateFormat</p>
<h6 id="NumberFormat"><a href="#NumberFormat" class="headerlink" title="@NumberFormat"></a>@NumberFormat</h6><p>数字转换，用String去接收excel数字格式的数据会调用这个注解。里面的value参照java.text.DecimalFormat</p>
<h5 id="常用Api"><a href="#常用Api" class="headerlink" title="常用Api"></a>常用Api</h5><p>EasyExcel 入口类，用于构建开始各种操作</p>
<p>ExcelReaderBuilder ExcelWriterBuilder 构建出一个 ReadWorkbook WriteWorkbook，可以理解成一个excel对象，一个excel只要构建一个</p>
<p>ExcelReaderSheetBuilder ExcelWriterSheetBuilder 构建出一个 ReadSheet WriteSheet对象，可以理解成excel里面的一页,每一页都要构建一个</p>
<p>ReadListener 在每一行读取完毕后都会调用ReadListener来处理数据</p>
<p>WriteHandler 在每一个操作包括创建单元格、创建表格等都会调用WriteHandler来处理数据</p>
<p>所有配置都是继承的，Workbook的配置会被Sheet继承，所以在用EasyExcel设置参数的时候，在EasyExcel…sheet()方法之前作用域是整个sheet,之后针对单个sheet</p>
<h6 id="读"><a href="#读" class="headerlink" title="读"></a>读</h6><p><strong>注解</strong></p>
<p>ExcelProperty 指定当前字段对应excel中的那一列。可以根据名字或者Index去匹配。当然也可以不写，默认第一个字段就是index&#x3D;0，以此类推。千万注意，要么全部不写，要么全部用index，要么全部用名字去匹配。千万别三个混着用，除非你非常了解源代码中三个混着用怎么去排序的。</p>
<p>Ø ExcelIgnore 默认所有字段都会和excel去匹配，加了这个注解会忽略该字段</p>
<p>Ø DateTimeFormat 日期转换，用String去接收excel日期格式的数据会调用这个注解。里面的value参照java.text.SimpleDateFormat</p>
<p>Ø NumberFormat 数字转换，用String去接收excel数字格式的数据会调用这个注解。里面的value参照java.text.DecimalFormat</p>
<p>Ø ExcelIgnoreUnannotated 默认不加ExcelProperty 的注解的都会参与读写，加了不会参与</p>
<p><strong>参数</strong></p>
<p>Ø converter 转换器，默认加载了很多转换器。也可以自定义。</p>
<p>Ø readListener 监听器，在读取数据的过程中会不断的调用监听器。</p>
<p>Ø headRowNumber 需要读的表格有几行头数据。默认有一行头，也就是认为第二行开始起为数据。</p>
<p>Ø head 与clazz二选一。读取文件头对应的列表，会根据列表匹配数据，建议使用class。</p>
<p>Ø clazz 与head二选一。读取文件的头对应的class，也可以使用注解。如果两个都不指定，则会读取全部数据。</p>
<p>Ø autoTrim 字符串、表头等数据自动trim</p>
<p>Ø password 读的时候是否需要使用密码</p>
<p>ReadWorkbook（理解成excel对象）参数<br>Ø excelType 当前excel的类型 默认会自动判断</p>
<p>Ø inputStream 与file二选一。读取文件的流，如果接收到的是流就只用，不用流建议使用file参数。因为使用了inputStream easyexcel会帮忙创建临时文件，最终还是file</p>
<p>Ø file 与inputStream二选一。读取文件的文件。</p>
<p>Ø autoCloseStream 自动关闭流。</p>
<p>Ø readCache 默认小于5M用 内存，超过5M会使用 EhCache,这里不建议使用这个参数。</p>
<p>ReadSheet（就是excel的一个Sheet）参数<br>Ø sheetNo 需要读取Sheet的编码，建议使用这个来指定读取哪个Sheet</p>
<p>Ø sheetName 根据名字去匹配Sheet,excel 2003不支持根据名字去匹配</p>
<h6 id="写"><a href="#写" class="headerlink" title="写"></a>写</h6><p><strong>注解</strong></p>
<p>Ø ExcelProperty index 指定写到第几列，默认根据成员变量排序。value指定写入的名称，默认成员变量的名字，多个value可以参照快速开始中的复杂头</p>
<p>Ø ExcelIgnore 默认所有字段都会写入excel，这个注解会忽略这个字段</p>
<p>Ø DateTimeFormat 日期转换，将Date写到excel会调用这个注解。里面的value参照java.text.SimpleDateFormat</p>
<p>Ø NumberFormat 数字转换，用Number写excel会调用这个注解。里面的value参照java.text.DecimalFormat</p>
<p>Ø ExcelIgnoreUnannotated 默认不加ExcelProperty 的注解的都会参与读写，加了不会参与</p>
<p><strong>通用参数</strong></p>
<p>Ø WriteWorkbook,WriteSheet ,WriteTable都会有的参数，如果为空，默认使用上级。</p>
<p>Ø converter 转换器，默认加载了很多转换器。也可以自定义。</p>
<p>Ø writeHandler 写的处理器。可以实现WorkbookWriteHandler,SheetWriteHandler,RowWriteHandler,CellWriteHandler，在写入excel的不同阶段会调用</p>
<p>Ø relativeHeadRowIndex 距离多少行后开始。也就是开头空几行</p>
<p>Ø needHead 是否导出头</p>
<p>Ø head 与clazz二选一。写入文件的头列表，建议使用class。</p>
<p>Ø clazz 与head二选一。写入文件的头对应的class，也可以使用注解。</p>
<p>Ø autoTrim 字符串、表头等数据自动trim</p>
<p><strong>WriteWorkbook（理解成excel对象）参数</strong><br>Ø excelType 当前excel的类型 默认xlsx</p>
<p>Ø outputStream 与file二选一。写入文件的流</p>
<p>Ø file 与outputStream二选一。写入的文件</p>
<p>Ø templateInputStream 模板的文件流</p>
<p>Ø templateFile 模板文件</p>
<p>Ø autoCloseStream 自动关闭流。</p>
<p>Ø password 写的时候是否需要使用密码</p>
<p>Ø useDefaultStyle 写的时候是否是使用默认头</p>
<p><strong>WriteSheet（就是excel的一个Sheet）参数</strong><br>Ø sheetNo 需要写入的编码。默认0</p>
<p>Ø sheetName 需要写的Sheet名称，默认同sheetNo</p>
<p><strong>WriteTable（就把excel的一个Sheet的一块区域看一个table）参数</strong><br>Ø tableNo 需要写入的编码。默认0 参数<br>Ø ReadWorkbook,ReadSheet 都会有的参数，如果为空，默认使用上级。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://daoqing312.github.io/2022/03/12/Excel%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/" data-id="cl0ntt3oi0001l8vaf6ad6o2d" data-title="Excel导入导出插件使用说明文档" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2022/03/12/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/03/12/Excel%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/">Excel导入导出插件使用说明文档</a>
          </li>
        
          <li>
            <a href="/2022/03/12/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 道庆<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>